{% extends "base.html.j2" %}

{% block title %}
    {{club.name}}
{% endblock %}

{% block body %}
    <div id = "club-container">
        <header id = "club-header">
            <h1>{{club.name}}</h1>
        </header>

        <aside id = "club-sidebar">
            <p>{{club.description}}</p>
            <hr>
            <h2>Leaders</h2>
            {% for leader in club.leaders %}
                <p>{{leader.name}}</p>
            {% endfor %}  
            <hr>
            {% if club.membership_type == 1 %}
                <div id = "import-user-message"></div>
                <textarea id = "import-user-text"></textarea>
                <button id = "import-user-button" onclick = 'importUsers({{club.id}});'>Import Members</button>
                <button onclick = 'copyUsers({{club.members|tojson}}, this);'>Copy Member Emails</button>
                <hr>
                <h2>Members</h2>
                <ul id = "club-user-list">
                    {% for member in club.members %}
                        <li onmouseover = "showMembershipActions(this);" onmouseout = "hideMembershipActions(this);">
                            {# 19 is number of characters in @lakesideschool.org #}
                            <p>{{member.email[:-19]}}</p>
                            <div class = "flex-space"></div>
                            <div class = "tooltip membership-action">
                                <span class = "material-symbol" onclick = 'addLeader({{club.id}}, {{member.id}}, this)'>add_moderator</span>
                                <span class = "tooltip-text">Add Leader</span>
                            </div>
                            <div class = "tooltip membership-action">
                                <span class = "material-symbol" onclick = 'kickMember({{club.id}}, {{member.id}}, this)'>person_remove</span>
                                <span class = "tooltip-text">Kick Member</span>
                            </div>
                        </li>
                    {% endfor %}
                </ul>
            {% elif club.membership_type == 0 %}
                <button onclick = "leaveClub({{club.id}}, this);">Leave Club</button>
            {% elif club.membership_type == None %}
                <button onclick = "joinClub({{club.id}}, {{g.user.authenticated|tojson}}, this);">Join Club!</button>
            {% endif %}
        </aside>

        <div id = "club-meetings-list">
            {% if club.membership_type == 1 %}
                <form class = "meeting-card" id = "new-meeting-card">
                    <input id = "new-meeting-title" type = "text" name = "title" placeholder = "Title">
                    <input id = "new-meeting-description" type = "text" name = "description" placeholder = "Description">
                    <hr>
                    <div class = "meeting-info">
                        <div id = "new-meeting-time">
                            <span class = "material-symbol">event</span>
                            <input type = "datetime-local" name = "start-time"> - 
                            <input type = "datetime-local" name = "end-time">
                        </div>
                        <div id = "new-meeting-location">
                            <span class = "material-symbol">location_on</span>
                            <input type = "text" name = "location" placeholder = "Location">
                        </div>
                        <div class = "flex-space"></div>
                        <input type = "submit" value = "Create Meeting">
                    </div>
                </form>
            {% endif %}
            {% for meeting in meetings %}
                <div class = "meeting-card">
                    <h2>{{meeting.title}}</h2>
                    {{meeting.description}}
                    <hr>
                    <div class = "meeting-info">
                        <div>
                            <span class = "material-symbol">event</span>
                            <p>{{meeting.start_time.strftime("%A, %b %-d")}}</p>
                        </div>
                        <div>
                            <span class = "material-symbol">schedule</span>
                            <p>{{meeting.start_time.strftime("%-I:%M")}} - {{meeting.end_time.strftime("%-I:%M")}}</p>
                        </div>
                        <div>
                            <span class = "material-symbol">location_on</span>
                            <p>{{meeting.location}}</p>
                        </div>
                        <div>
                            <span class = "material-symbol">person</span>
                            <div>
                                <span>{{meeting.members|length}}</span> <span class = "meeting-info-hide">attendee{{'' if meeting.members|length == 1 else 's'}}</span>
                            </div>
                        </div>
                        <div class = "flex-space"></div>
                        {% if meeting.is_member %}
                            <button onclick = "leaveMeeting({{meeting.id}}, this);">Leave Meeting</button>
                        {% else %}
                            <button onclick = "joinMeeting({{meeting.id}}, this);">Join Meeting</button>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}