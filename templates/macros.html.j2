{% macro display_name(person) %}
    {% if person.first_name and person.last_name %}
        {% if g.user.authenticated %}
            {{person.first_name}} {{person.last_name}}
        {% else %}
            {{person.first_name}} {{person.last_name[0]}}.
        {% endif %}
    {% elif person.email %}
        <span>{{person.email[:-22]|capitalize}} {{person.email[-22]|capitalize}}</span>
        <span data-tooltip = "This name might be inaccurate since this user never logged in.">
            <span class = "material-symbol">info</span>
        </span>
    {% endif %}
{% endmacro %}

{% macro render_club_card(club) %}
    <div class = "club-card">
        <a href = "club?id={{club.club_id}}">
            <h2>{{club.name}}</h2>
        </a>
        <p>{{club.description}}</p>
        <div class = "flex-space"></div>
        <hr>
        <div class = "club-tags">
            {% for tag in club.tags %}
                <div class = "club-tag">{{tag.name}}</div>
            {% endfor %}
        </div>
        <div class = "card-info">
            <div class = "card-time">
                <span class = "material-symbol">event</span>
                <p>{{club.time}}</p>
            </div>
            <div>
                <span class = "material-symbol">location_on</span>
                <p>{{club.location}}</p>
            </div>
            <div class = "flex-space"></div>
            {% if not club.is_member %}
                <button type = "button" data-action = "join-club" data-club-id = "{{club.club_id}}" data-authenticated = "{{g.user.authenticated}}">
                    <span class = "button-label">Join Club</span>
                    <span class = "material-symbol">login</span>
                </button>
            {% elif not club.is_leader %}
                <button type = "button" data-action = "leave-club" data-club-id = "{{club.club_id}}" data-authenticated = "{{g.user.authenticated}}">
                    <span class = "button-label">Leave Club</span>
                    <span class = "material-symbol">logout</span>
                </button>
            {% endif %}
        </div>
    </div>
{% endmacro %}

{% macro render_meeting_card(meeting, is_meeting, is_club_page) %}
    <div class = "meeting-card">
        {% if is_club_page %}
            <h2>{{meeting.title|e}}</h2>            
        {% else %}
            <a href = "club?id={{meeting.club_id}}">
                <h2>{{meeting.club_name}}</h2>
            </a>
            <h3>{{meeting.title|e}}</h3>
        {% endif %}
        <div class = "meeting-description">{{meeting.description}}</div>
        <hr>
        <div class = "card-info">
            {% if is_meeting %}
                <div>
                    <span class = "material-symbol">event</span>
                    <p>{{meeting.date.strftime("%A, %b %-d")}}</p>
                </div>
                <div>
                    <span class = "material-symbol">schedule</span>
                    {# convert meeting.start_time to string by concantenating with blank then remove seconds #}
                    <p>{{(meeting.start_time ~ "")[:-3]}} - {{(meeting.end_time ~ "")[:-3]}}</p>
                </div>
                <div>
                    <span class = "material-symbol">location_on</span>
                    <p>{{meeting.location}}</p>
                </div>
            {% else %}
                {% if is_club_page and (club.is_leader or g.user.is_admin) %}
                    <button type = "button" data-action = "email-meeting" data-club-id = "{{club.id}}" data-meeting-id = "{{meeting.id}}" data-meeting-title = "{{meeting.title|e}}" data-meeting-description = "{{meeting.description_plain|e}}">
                        <span class = "button-label">Email Announcement</span>
                        <span class = "material-symbol">mail</span>
                    </button>
                    <button type = "button" data-action = "delete-meeting" data-meeting-id = "{{meeting.id}}" data-club-id = "{{club.id}}">
                        <span class = "button-label">Delete Announcement</span>
                        <span class = "material-symbol">delete</span>
                    </button>
                {% endif %}
            {% endif %}
            <div class = "flex-space"></div>
            {% if is_meeting %}
                {% if is_club_page and (club.is_leader or g.user.is_admin) %}             
                    <button type = "button" data-action = "email-meeting" data-club-id = "{{club.id}}" data-meeting-id = "{{meeting.id}}" data-meeting-title = "{{meeting.title|e}}" data-meeting-description = "{{meeting.description_plain|e}}">
                        <span class = "button-label">Email Meeting</span>
                        <span class = "material-symbol">mail</span>
                    </button>
                    <button type = "button" data-action = "delete-meeting" data-meeting-id = "{{meeting.id}}" data-club-id = "{{club.id}}">
                        <span class = "button-label">Delete Meeting</span>
                        <span class = "material-symbol">delete</span>
                    </button>
                {% endif %}
            {% else %}
                <small>Posted on {{meeting.post_time.strftime("%A, %B %-d at %I:%M %p")}}</small>
            {% endif %}
        </div>
    </div>
{% endmacro %}
